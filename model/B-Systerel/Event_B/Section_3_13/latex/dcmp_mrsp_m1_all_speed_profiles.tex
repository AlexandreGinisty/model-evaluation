\begin{description}
\MACHINE{dcmp\_mrsp\_m1\_all\_speed\_profiles}
\REFINES{dcmp\_mrsp\_m0}
\SEES{c6\_supervision\_limits, ctx\_functions\_0}
\VARIABLES
        \begin{description}
                \ItemY{ MRSP }{Shared variable, DO NOT REFINE}
                \ItemY{ a\_current }{Shared variable, DO NOT REFINE}
                \ItemY{ v\_current }{Shared variable, DO NOT REFINE}
                \ItemY{ loc\_current }{Shared variable, DO NOT REFINE}
        \end{description}
\EVENTS
        \INITIALISATION
                \\\textit{extended}
                \begin{description}
                \BeginAct
                        \begin{description}
                        \nItemX{ act1 }{ v\_current :=  c\_v0 }
                        \nItemX{ act2 }{ a\_current :=  c\_a0 }
                        \nItemX{ act3 }{ loc\_current :=  c\_l0 }
                        \nItemX{ act17 }{ MRSP :=  c\_speed\_profile0 }
                        \end{description}
                \EndAct
                \end{description}
        \EVT {update\_train\_state}\cmt{		\\\hspace*{4,2 cm}  External event, DO NOT REFINE }
        \EXTD {update\_train\_state}
                \begin{description}
                \AnyPrm
                        \begin{description}
                        \ItemX{l\_speed }
                        \ItemX{l\_accel }
                        \ItemX{l\_loc }
                        \end{description}
                \WhereGrd
                        \begin{description}
                        \nItemX{ grd1 }{ l\_speed \in  t\_speed }
                        \nItemX{ grd2 }{ l\_accel \in  t\_acceleration }
                        \nItemX{ grd3 }{ l\_loc \in  t\_locations }
                        \end{description}
                \ThenAct
                        \begin{description}
                        \nItemX{ act1 }{ v\_current :=  l\_speed }
                        \nItemX{ act2 }{ a\_current :=  l\_accel }
                        \nItemX{ act3 }{ loc\_current :=  l\_loc }
                        \end{description}
                \EndAct
                \end{description}
        \EVT {calculate\_MRSP\_from\_all\_speed\_restrictions}
        \REF {set\_MRSP}
                \begin{description}
                \AnyPrm
                        \begin{description}
                        \Item{l\_SSP }
                        \ItemY{l\_AxleLoadSP }{ }
                        \Item{l\_TSR }
                        \Item{l\_SignalRelatedSP }
                        \Item{l\_mode }
                        \Item{l\_modeRelatedSP }
                        \ItemY{l\_LXSP }{ }
                        \Item{l\_OverrideFuncSP }
                        \Item{l\_ensureBrakingDistanceSP }
                        \end{description}
                \WhereGrd
                        \begin{description}
                        \nItem{ grd2 }{ l\_SSP \in  t\_speed\_profiles }
                        \nItemY{ grd3 }{ l\_AxleLoadSP \in  t\_speed\_profiles }{ }
                        \nItem{ grd4 }{ l\_TSR \in  t\_speed\_profiles }
                        \nItem{ grd5 }{ l\_SignalRelatedSP \in  t\_speed\_profiles }
                        \nItem{ grd6 }{ l\_mode \in  t\_train\_modes }
                        \nItem{ grd7 }{ l\_modeRelatedSP \in  t\_speed\_profiles }
                        \nItem{ grd8 }{ l\_LXSP \in  t\_speed\_profiles }
                        \nItemY{ grd9 }{ l\_OverrideFuncSP \in  t\_speed\_profiles }{ }
                        \nItem{ grd10 }{ l\_ensureBrakingDistanceSP \in  t\_speed\_profiles }
                        \end{description}
                \Witnesses
                        \begin{description}
                        \nItemX{ l\_sp }{ l\_sp = f\_mrsp(l\_SSP \mapsto  l\_AxleLoadSP \mapsto  l\_TSR \mapsto  l\_SignalRelatedSP		\\\hspace*{3,6 cm}  \mapsto  l\_modeRelatedSP \mapsto  l\_LXSP \mapsto  l\_OverrideFuncSP \mapsto  l\_ensureBrakingDistanceSP		\\\hspace*{3,6 cm}  \mapsto  l\_mode \mapsto  c\_train\_max\_speed \mapsto  c\_train\_length) }
                        \end{description}
                \ThenAct
                        \begin{description}
                        \nItem{ act1 }{ MRSP :=  f\_mrsp(l\_SSP \mapsto  l\_AxleLoadSP \mapsto  l\_TSR \mapsto  l\_SignalRelatedSP		\\\hspace*{3,6 cm}  \mapsto  l\_modeRelatedSP \mapsto  l\_LXSP \mapsto  l\_OverrideFuncSP \mapsto  l\_ensureBrakingDistanceSP		\\\hspace*{3,6 cm}  \mapsto  l\_mode \mapsto  c\_train\_max\_speed \mapsto  c\_train\_length) }
                        \end{description}
                \EndAct
                \end{description}
\END
\end{description}
